---
import { userIsAdmin } from "@/features/shared/roles";
import Layout from "@/layouts/Layout.astro";

const { user } = Astro.locals;

const isAdmin = userIsAdmin(user);
---

<Layout title="Welcome to Astro.">
  <h1
    class="text-6xl font-bold bg-gradient-to-r from-purple-600 dark:from-purple-600 via-purple-800 to-purple-900 dark:to-purple-700 inline-block text-transparent bg-clip-text"
  >
    Supabase Astro Template
  </h1>
  {
    user ? (
      <>
        <p class="text-xl">Welcome, {user.email}</p>
        <a
          class="inline-flex items-center justify-center rounded-md bg-gray-900 px-4 py-2 text-sm font-medium text-gray-50 shadow transition-colors hover:bg-gray-900/90 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90 dark:focus-visible:ring-gray-300"
          href="/api/auth/logout"
        >
          Logout
        </a>
      </>
    ) : (
      <a
        class="inline-flex items-center justify-center rounded-md bg-gray-900 px-4 py-2 text-sm font-medium text-gray-50 shadow transition-colors hover:bg-gray-900/90 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90 dark:focus-visible:ring-gray-300"
        href="/login"
      >
        Login
      </a>
    )
  }
  <a
    class="inline-flex items-center justify-center rounded-md bg-gray-900 px-4 py-2 text-sm font-medium text-gray-50 shadow transition-colors hover:bg-gray-900/90 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90 dark:focus-visible:ring-gray-300"
    href="/pricing"
  >
    Go to Pricing
  </a>
  {
    isAdmin && (
      <a
        class="inline-flex items-center justify-center rounded-md bg-gray-900 px-4 py-2 text-sm font-medium text-gray-50 shadow transition-colors hover:bg-gray-900/90 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90 dark:focus-visible:ring-gray-300"
        href="/admin"
      >
        Go to Admin
      </a>
    )
  }
</Layout>
